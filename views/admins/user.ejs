<% layout('../layouts/main') -%>
<%-partial('../partials/nav')%>
<%-partial('../partials/messages')%>

<nav aria-label="breadcrumb">
    <ol class="breadcrumb">
        <li class="breadcrumb-item"><a href="/">Главная</a></li>
        <li class="breadcrumb-item"><a href="/admin">Админ</a></li>
        <li class="breadcrumb-item"><a href="/admin/users">Пользователи</a></li>
        <li class="breadcrumb-item active" aria-current="page"><%= title %></li>
    </ol>
</nav>

<div class="container">
    <div class="row">
        <div class="col-md-6">
            <h3 class="text-center">Информация</h3>
            <hr>
            <p><b>Id: </b><%= data.id %></p>
            <p><b>Логин: </b><%= data.login %></p>
            <p><b>Email: </b><%= data.email %></p>
            <p><b>Роль: </b><%= data.roleName %></p>
            <p><b>Статус: </b><%= data.statusName %></p>
            <p><b>Реферал: </b><%if (data.userRef) {%> <a href="/admin/users/<%= data.userRef.id %>"><%= data.userRef.login %></a> <%}else{%>нет реферала<%}%></p>
            <p><b>Дата регистрации: </b><%= data.createdAt %></p>
        </div>
        <div class="col-md-6">
            <h3 class="text-center">Действия</h3>
            <hr>
            <div class="form-group">
                <a href="/admin/users/<%= data.id %>/edit" class="btn btn-warning btn-block">Редактировать</a>
            </div>
            <div class="form-group">
                <a href="/admin/users?ref=<%= data.id %>" class="btn btn-info btn-block">Список рефералов</a>
            </div>
            <div class="form-group">
                <a href="/admin/authorizations?user=<%= data.id %>" class="btn btn-success btn-block">История
                    авторизаций</a>
            </div>
            <div class="form-group">
                <a href="/admin/notifications?user=<%= data.id %>" class="btn btn-info btn-block">История
                    уведомлений</a>
            </div>
            <div class="form-group">
                <form action="/admin/users/<%= data.id %>/block" method="POST">
                    <input type="hidden" name="_csrf" value="<%=csrfToken%>">
                    <button type="submit" class="btn btn-danger btn-block" onclick="return confirm('Точно выполнить данное действие?')">Блокировать / Разблокировать</button>
                </form>
            </div>
        </div>
    </div>
    <hr>
    <div class="row">
        <div class="col-md-6">
            <h3 class="text-center">Отправить уведомление</h3>
            <hr>
            <form action="/admin/users/<%= data.id %>/notifications" method="POST">
                <input type="hidden" name="_csrf" value="<%=csrfToken%>">

                <div class="form-group">
                    <label for="validationTextarea">Название уведомления</label>
                    <input type="text" name="name" id="validationTextarea" class="form-control" placeholder="Название уведомления">
                </div>

                <div class="form-group">
                    <label for="validationTextarea">Текст уведомления</label>
                    <textarea name="text" class="form-control" id="validationTextarea" placeholder="Текст уведомления"></textarea>
                </div>

                <button type="submit" class="btn btn-info btn-block">Отправить</button>
            </form>
        </div>
    </div>
</div>